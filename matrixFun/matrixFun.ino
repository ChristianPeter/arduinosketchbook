int rows[8] = {9,3,2,12,15,11,7,6};
int cols[8] = {13,8,17,10,5,16,4,14};

int img[10][8][8] = 
{
{
{0,0,1,1,1,1,0,0},
{0,1,1,1,1,1,1,0},
{0,1,1,0,0,1,1,0},
{0,1,1,0,0,1,1,0},
{0,1,1,0,0,1,1,0},
{0,1,1,0,0,1,1,0},
{0,1,1,1,1,1,1,0},
{0,0,1,1,1,1,0,0}
},
{
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1}
},
{
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1}
},
{
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1}
},
{
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1}
},
{
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1}
},
{
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1}
},
{
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1}
},
{
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1}
},
{
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1},
{0,1,1,1,1,1,0,1}
}
};

int screen[] = {
1,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0
};

void drawScreen(){
  for (int y = 0; y < 8; y++){
    for (int x = 0; x < 8; x++){    
      digitalWrite(cols[x], screen[y*8+x] == 1 ? HIGH : LOW);      
    }
    digitalWrite(rows[y], LOW);    
    delayMicroseconds(100);    
    digitalWrite(rows[y], HIGH);
  }
}

void putPixel(byte x, byte y, byte c){
  screen[y*8+x] = c;
}

void doSomething(){
  byte temp = screen[0];
  for (int i = 0 ; i < 64 ; i++){
    screen[i]=screen[(i+1) % 64];
  }
  screen[63] = temp;
}


long count = 0;
void loop(){
  count++;
  //int r = analogRead(4);
//  int rv = map(r, 0, 1023,1,500);
  int rv= 10;
  drawScreen();
  
  if (count > rv){
    count = 0;
    doSomething();
  }
  
  
  if (count % 100){
    byte rn = random(10);
    putPixel(random(8), random(8), rn > 5? 1 : 0);
  }
  
 
}

int index = 0;


void setup() {
  // put your setup code here, to run once:
  for (int i = 0; i < 8; i++){
    pinMode(rows[i], OUTPUT);
    pinMode(cols[i], OUTPUT);
    digitalWrite(cols[i], LOW);
    digitalWrite(rows[i], LOW);
  }
}


void loopx() {
  count ++;
  
  int r = analogRead(4);
  int rv = map(r, 0, 1023,10,100);
//  if (count % 100 == 0) index++;
  if (count > rv){
    count = 0;
    index++;
  }
  
  for (int y = 0; y< 8; y++){
    
    for (int x = 0; x < 8; x++){
      digitalWrite(cols[x], img[index % 10][x][y] == 1 ? HIGH : LOW);  
    }

   digitalWrite(rows[y], LOW);  
   delayMicroseconds(10000);    
   digitalWrite(rows[y], HIGH);
   delayMicroseconds(10000);


  }
  

}
